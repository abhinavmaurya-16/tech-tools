<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Free online image compression tool. Compress JPEG, PNG, WEBP images to your desired file size. Adjust compression level to optimize your images.">
    <meta name="keywords" content="image compression, compress images, optimize images, reduce image size, image optimizer, size compression">
    <title>SmartImage Compressor - Adjust Image Size Online</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 30px 0;
            margin-bottom: 30px;
        }

        header h1 {
            font-size: 2.8rem;
            color: #2c3e50;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #3498db, #2c3e50);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        header p {
            font-size: 1.2rem;
            color: #7f8c8d;
            max-width: 800px;
            margin: 0 auto;
        }

        .compression-box {
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 30px;
            margin-bottom: 30px;
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .upload-area {
            border: 3px dashed #3498db;
            border-radius: 10px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: #f8fafc;
            position: relative;
        }

        .upload-area:hover {
            background: #e8f4ff;
            border-color: #2980b9;
        }

        .upload-area i {
            font-size: 60px;
            color: #3498db;
            margin-bottom: 15px;
        }

        .upload-area h3 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .upload-area p {
            color: #7f8c8d;
        }

        #file-input {
            display: none;
        }

        .file-info {
            margin-top: 15px;
            padding: 10px;
            background: #e8f4ff;
            border-radius: 8px;
            display: none;
        }

        .controls {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        @media (min-width: 768px) {
            .controls {
                grid-template-columns: 1fr 1fr;
            }
        }

        .control-group {
            background: #f8fafc;
            padding: 20px;
            border-radius: 10px;
        }

        .control-group h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .control-group h4 i {
            color: #3498db;
        }

        .slider-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .size-input {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
        }

        .size-input input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .size-input select {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            -webkit-appearance: none;
            appearance: none;
            background: #dfe6e9;
            border-radius: 5px;
            outline: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
            transition: background 0.3s;
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            background: #2980b9;
        }

        .format-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .format-option {
            flex: 1;
            min-width: 80px;
            text-align: center;
            padding: 10px;
            background: #e8f4ff;
            border: 2px solid #3498db;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .format-option.active {
            background: #3498db;
            color: white;
        }

        .format-option:hover {
            background: #2980b9;
            color: white;
        }

        .preview-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        @media (min-width: 992px) {
            .preview-container {
                grid-template-columns: 1fr 1fr;
            }
        }

        .preview-box {
            background: #f8fafc;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }

        .preview-box h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .image-preview {
            width: 100%;
            height: 250px;
            object-fit: contain;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: white;
            margin-bottom: 15px;
        }

        .image-info {
            display: flex;
            justify-content: space-around;
            font-size: 0.9rem;
            color: #7f8c8d;
        }

        .compression-info {
            background: #e8f4ff;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            text-align: center;
            display: none;
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
        }

        .btn-outline {
            background: transparent;
            color: #3498db;
            border: 2px solid #3498db;
        }

        .btn-outline:hover {
            background: #e8f4ff;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .ad-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            padding: 20px;
            margin: 30px 0;
            text-align: center;
        }

        .ad-container h3 {
            color: #7f8c8d;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .ad-placeholder {
            background: #f8fafc;
            height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            color: #7f8c8d;
            font-size: 1.1rem;
        }

        footer {
            text-align: center;
            padding: 30px 0;
            color: #7f8c8d;
            margin-top: 40px;
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }

        .feature {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            text-align: center;
        }

        .feature i {
            font-size: 40px;
            color: #3498db;
            margin-bottom: 15px;
        }

        .feature h3 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .feature p {
            color: #7f8c8d;
        }

        .progress-bar {
            height: 6px;
            background: #dfe6e9;
            border-radius: 3px;
            margin-top: 10px;
            overflow: hidden;
            display: none;
        }

        .progress {
            height: 100%;
            background: #3498db;
            width: 0%;
            transition: width 0.3s;
        }

        .size-validation {
            color: #e74c3c;
            font-size: 0.9rem;
            margin-top: 5px;
            display: none;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 2.2rem;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>SmartImage Compressor</h1>
            <p>Compress and optimize your images to your desired file size. Perfect for websites, social media, and storage. Supports images up to 10MB.</p>
        </header>

        <div class="compression-box">
            <div class="upload-area" id="drop-area">
                <i class="fas fa-cloud-upload-alt"></i>
                <h3>Drag & Drop your image here</h3>
                <p>or click to browse files (Max: 10MB)</p>
                <input type="file" id="file-input" accept="image/*">
                <div class="file-info" id="file-info">
                    <span id="file-name"></span> • <span id="file-size"></span>
                </div>
                <div class="progress-bar" id="progress-bar">
                    <div class="progress" id="progress"></div>
                </div>
            </div>

            <div class="controls">
                <div class="control-group">
                    <h4><i class="fas fa-weight-hanging"></i> Target Size</h4>
                    <div class="size-input">
                        <input type="number" id="target-size" min="10" max="3000" value="500">
                        <select id="size-unit">
                            <option value="KB">KB</option>
                            <option value="MB">MB</option>
                        </select>
                    </div>
                    <div class="size-validation" id="size-validation">
                        Please enter a value between 10KB and 3MB
                    </div>
                    <p class="size-help">Enter your desired output size (10KB - 3MB)</p>
                    
                    <h4 style="margin-top: 20px;"><i class="fas fa-expand-arrows-alt"></i> Output Format</h4>
                    <div class="format-options">
                        <div class="format-option active">JPG</div>
                        <div class="format-option">PNG</div>
                        <div class="format-option">WEBP</div>
                    </div>
                </div>

                <div class="control-group">
                    <h4><i class="fas fa-sliders-h"></i> Compression Parameters</h4>
                    <div class="slider-container">
                        <label for="quality-level">Image Quality</label>
                        <input type="range" id="quality-level" min="40" max="100" value="85">
                        <div class="slider-labels">
                            <span>Lower Quality</span>
                            <span>Higher Quality</span>
                        </div>
                    </div>
                    
                    <div class="slider-container" style="margin-top: 20px;">
                        <label for="resize-level">Resize Image</label>
                        <input type="range" id="resize-level" min="10" max="100" value="100">
                        <div class="slider-labels">
                            <span>Smaller Size</span>
                            <span>Original Size</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="preview-container">
                <div class="preview-box">
                    <h3>Original Image</h3>
                    <img id="original-preview" class="image-preview" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='200' viewBox='0 0 400 200'%3E%3Crect width='400' height='200' fill='%23f8fafc'/%3E%3Cpath d='M150 100 L200 70 L250 100 L250 150 L200 180 L150 150 Z' fill='%23e8f4ff' stroke='%233498db' stroke-width='2'/%3E%3Ccircle cx='200' cy='100' r='30' fill='%233498db' opacity='0.2'/%3E%3C/svg%3E" alt="Original preview">
                    <div class="image-info">
                        <span id="original-size">0 KB</span>
                        <span id="original-dimensions">0 x 0</span>
                    </div>
                </div>

                <div class="preview-box">
                    <h3>Compressed Image</h3>
                    <img id="compressed-preview" class="image-preview" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='200' viewBox='0 0 400 200'%3E%3Crect width='400' height='200' fill='%23f8fafc'/%3E%3Cpath d='M150 100 L200 70 L250 100 L250 150 L200 180 L150 150 Z' fill='%23e8f4ff' stroke='%232980b9' stroke-width='2'/%3E%3Ccircle cx='200' cy='100' r='30' fill='%232980b9' opacity='0.2'/%3E%3C/svg%3E" alt="Compressed preview">
                    <div class="image-info">
                        <span id="compressed-size">0 KB</span>
                        <span id="compressed-dimensions">0 x 0</span>
                    </div>
                    <div class="compression-info" id="compression-info">
                        <span id="compression-ratio">0%</span> size reduction
                    </div>
                </div>
            </div>

            <div class="action-buttons">
                <button id="compress-btn" class="btn btn-primary" disabled>
                    <i class="fas fa-compress-alt"></i> Compress Image
                </button>
                <button id="download-btn" class="btn btn-outline" disabled>
                    <i class="fas fa-download"></i> Download
                </button>
            </div>
        </div>

        <div class="ad-container">
            <h3>Advertisement</h3>
            <div class="ad-placeholder">
                <!-- Google AdSense Ad Unit -->
                <!-- Replace with your AdSense code -->
                <div style="padding: 20px; background: #e8f4ff; border-radius: 8px;">
                    <p>Ad Space (300x250)</p>
                    <p>Google AdSense Ad Unit</p>
                </div>
            </div>
        </div>

        <div class="features">
            <div class="feature">
                <i class="fas fa-bullseye"></i>
                <h3>Target Size Compression</h3>
                <p>Specify exactly how small you want your image to be (10KB-3MB)</p>
            </div>
            <div class="feature">
                <i class="fas fa-lock"></i>
                <h3>Secure & Private</h3>
                <p>Your images are processed locally and never uploaded to any server</p>
            </div>
            <div class="feature">
                <i class="fas fa-mobile-alt"></i>
                <h3>Responsive Design</h3>
                <p>Works perfectly on desktop, tablet, and mobile devices</p>
            </div>
        </div>
    </div>

    <footer>
        <p>© 2023 SmartImage Compressor. All rights reserved.</p>
        <p>This tool is built with HTML5, CSS3, and JavaScript. No server-side processing required.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const fileInput = document.getElementById('file-input');
            const dropArea = document.getElementById('drop-area');
            const qualityLevel = document.getElementById('quality-level');
            const resizeLevel = document.getElementById('resize-level');
            const compressBtn = document.getElementById('compress-btn');
            const downloadBtn = document.getElementById('download-btn');
            const originalPreview = document.getElementById('original-preview');
            const compressedPreview = document.getElementById('compressed-preview');
            const originalSize = document.getElementById('original-size');
            const compressedSize = document.getElementById('compressed-size');
            const originalDimensions = document.getElementById('original-dimensions');
            const compressedDimensions = document.getElementById('compressed-dimensions');
            const formatOptions = document.querySelectorAll('.format-option');
            const fileInfo = document.getElementById('file-info');
            const fileName = document.getElementById('file-name');
            const fileSizeElement = document.getElementById('file-size');
            const compressionInfo = document.getElementById('compression-info');
            const compressionRatio = document.getElementById('compression-ratio');
            const progressBar = document.getElementById('progress-bar');
            const progress = document.getElementById('progress');
            const targetSizeInput = document.getElementById('target-size');
            const sizeUnitSelect = document.getElementById('size-unit');
            const sizeValidation = document.getElementById('size-validation');
            
            let currentFile = null;
            let compressedImageData = null;
            let selectedFormat = 'JPG';
            let targetSizeBytes = 500 * 1024; // Default 500KB

            // Event listeners for format options
            formatOptions.forEach(option => {
                option.addEventListener('click', function() {
                    formatOptions.forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                    selectedFormat = this.textContent;
                });
            });

            // Validate target size input
            targetSizeInput.addEventListener('change', validateTargetSize);
            sizeUnitSelect.addEventListener('change', validateTargetSize);
            
            function validateTargetSize() {
                let size = parseInt(targetSizeInput.value);
                const unit = sizeUnitSelect.value;
                
                if (isNaN(size)) {
                    sizeValidation.textContent = "Please enter a valid number";
                    sizeValidation.style.display = "block";
                    return false;
                }
                
                if (unit === 'KB') {
                    if (size < 10 || size > 3072) { // 3MB = 3072KB
                        sizeValidation.textContent = "Please enter a value between 10KB and 3072KB";
                        sizeValidation.style.display = "block";
                        return false;
                    }
                    targetSizeBytes = size * 1024;
                } else { // MB
                    if (size < 0.01 || size > 3) {
                        sizeValidation.textContent = "Please enter a value between 0.01MB and 3MB";
                        sizeValidation.style.display = "block";
                        return false;
                    }
                    targetSizeBytes = size * 1024 * 1024;
                }
                
                sizeValidation.style.display = "none";
                return true;
            }

            // Drag and drop functionality
            dropArea.addEventListener('click', () => fileInput.click());
            
            dropArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropArea.style.background = '#e8f4ff';
                dropArea.style.borderColor = '#2980b9';
            });
            
            dropArea.addEventListener('dragleave', () => {
                dropArea.style.background = '#f8fafc';
                dropArea.style.borderColor = '#3498db';
            });
            
            dropArea.addEventListener('drop', (e) => {
                e.preventDefault();
                dropArea.style.background = '#f8fafc';
                dropArea.style.borderColor = '#3498db';
                
                if (e.dataTransfer.files.length) {
                    handleImageUpload(e.dataTransfer.files[0]);
                }
            });
            
            fileInput.addEventListener('change', () => {
                if (fileInput.files.length) {
                    handleImageUpload(fileInput.files[0]);
                }
            });

            // Compression functionality
            compressBtn.addEventListener('click', compressImage);
            
            downloadBtn.addEventListener('click', () => {
                if (compressedImageData) {
                    const link = document.createElement('a');
                    link.download = `compressed-image.${selectedFormat.toLowerCase()}`;
                    link.href = compressedImageData;
                    link.click();
                }
            });

            // Handle image upload
            function handleImageUpload(file) {
                if (!file.type.match('image.*')) {
                    alert('Please select an image file.');
                    return;
                }
                
                if (file.size > 10 * 1024 * 1024) {
                    alert('Please select an image smaller than 10MB.');
                    return;
                }
                
                currentFile = file;
                
                // Show file info
                fileName.textContent = file.name;
                fileSizeElement.textContent = formatFileSize(file.size);
                fileInfo.style.display = 'block';
                
                // Show progress bar and simulate progress
                progressBar.style.display = 'block';
                progress.style.width = '0%';
                
                let width = 0;
                const interval = setInterval(() => {
                    if (width >= 100) {
                        clearInterval(interval);
                    } else {
                        width += 5;
                        progress.style.width = width + '%';
                    }
                }, 50);
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    // Hide progress bar when done
                    setTimeout(() => {
                        progressBar.style.display = 'none';
                    }, 500);
                    
                    originalPreview.src = e.target.result;
                    originalSize.textContent = formatFileSize(file.size);
                    
                    const img = new Image();
                    img.onload = function() {
                        originalDimensions.textContent = `${img.width} x ${img.height}`;
                    };
                    img.src = e.target.result;
                    
                    compressBtn.disabled = false;
                    downloadBtn.disabled = true;
                };
                reader.readAsDataURL(file);
            }

            // Compress image based on target size
            function compressImage() {
                if (!currentFile || !validateTargetSize()) return;
                
                // Show progress bar for compression
                progressBar.style.display = 'block';
                progress.style.width = '0%';
                
                let width = 0;
                const interval = setInterval(() => {
                    if (width >= 100) {
                        clearInterval(interval);
                    } else {
                        width += 10;
                        progress.style.width = width + '%';
                    }
                }, 50);
                
                setTimeout(() => {
                    const img = new Image();
                    img.onload = function() {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        
                        // Calculate resize percentage
                        const resizePercent = parseInt(resizeLevel.value) / 100;
                        let width = img.width * resizePercent;
                        let height = img.height * resizePercent;
                        
                        canvas.width = width;
                        canvas.height = height;
                        
                        // Draw image on canvas
                        ctx.drawImage(img, 0, 0, width, height);
                        
                        // Get the selected format
                        let mimeType = 'image/jpeg';
                        if (selectedFormat === 'PNG') mimeType = 'image/png';
                        if (selectedFormat === 'WEBP') mimeType = 'image/webp';
                        
                        // Binary search for optimal quality to meet target size
                        let minQuality = 0.1;
                        let maxQuality = 1.0;
                        let bestQuality = 0.8;
                        let compressedData;
                        
                        for (let i = 0; i < 10; i++) {
                            bestQuality = (minQuality + maxQuality) / 2;
                            compressedData = canvas.toDataURL(mimeType, bestQuality);
                            
                            // Calculate compressed size (approximate)
                            const compressedSizeBytes = Math.round((compressedData.length * 3) / 4);
                            
                            if (compressedSizeBytes < targetSizeBytes) {
                                minQuality = bestQuality;
                            } else {
                                maxQuality = bestQuality;
                            }
                            
                            // If we're close enough, break early
                            if (Math.abs(compressedSizeBytes - targetSizeBytes) < targetSizeBytes * 0.05) {
                                break;
                            }
                        }
                        
                        // Final compression with best quality found
                        compressedImageData = canvas.toDataURL(mimeType, bestQuality);
                        
                        // Update compressed preview
                        compressedPreview.src = compressedImageData;
                        compressedDimensions.textContent = `${Math.round(width)} x ${Math.round(height)}`;
                        
                        // Calculate compressed size
                        const compressedSizeBytes = Math.round((compressedImageData.length * 3) / 4);
                        compressedSize.textContent = formatFileSize(compressedSizeBytes);
                        
                        // Calculate compression ratio
                        const originalSizeBytes = currentFile.size;
                        const ratio = Math.round((1 - (compressedSizeBytes / originalSizeBytes)) * 100);
                        compressionRatio.textContent = `${ratio}%`;
                        compressionInfo.style.display = 'block';
                        
                        // Enable download button
                        downloadBtn.disabled = false;
                        
                        // Hide progress bar when done
                        progressBar.style.display = 'none';
                    };
                    img.src = originalPreview.src;
                }, 800);
            }

            // Format file size
            function formatFileSize(bytes) {
                if (bytes < 1024) {
                    return bytes + ' bytes';
                } else if (bytes < 1048576) {
                    return (bytes / 1024).toFixed(2) + ' KB';
                } else {
                    return (bytes / 1048576).toFixed(2) + ' MB';
                }
            }
        });
    </script>
</body>
</html>
